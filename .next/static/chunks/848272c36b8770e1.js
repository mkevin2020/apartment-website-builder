(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20383,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(18566),r=e.i(27341),l=e.i(67881),n=e.i(7486),i=e.i(92270),c=e.i(22016);function d({admin:e,onLogout:a}){return(0,s.jsx)("header",{className:"border-b bg-card",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[(0,s.jsxs)(c.default,{href:"/admin/dashboard",className:"flex items-center gap-2",children:[(0,s.jsx)(n.Building2,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("span",{className:"font-bold text-xl",children:"Cielo Vista Admin"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Logged in as ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.username})]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:a,children:[(0,s.jsx)(i.LogOut,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})})}e.i(47167),e.i(29225);var o=e.i(72390),m=e.i(23750),x=e.i(30374);function u({isOpen:e,onClose:t,adminId:r,onSuccess:n}){let[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(""),[h,p]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),g=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q"),j=async e=>{if(e.preventDefault(),u(""),!h.currentPassword||!h.newPassword||!h.confirmPassword)return void u("All fields are required");if(h.newPassword!==h.confirmPassword)return void u("New passwords do not match");if(h.newPassword.length<6)return void u("Password must be at least 6 characters long");c(!0);try{let e=JSON.parse(localStorage.getItem("admin_session")||"{}");if(e.password!==h.currentPassword){u("Current password is incorrect"),c(!1);return}let{error:s}=await g.from("admin_accounts").update({password:h.newPassword}).eq("id",r);if(s){u("Failed to update password"),c(!1);return}e.password=h.newPassword,localStorage.setItem("admin_session",JSON.stringify(e)),p({currentPassword:"",newPassword:"",confirmPassword:""}),n(),t()}catch(e){u("An error occurred. Please try again.")}finally{c(!1)}};return(0,s.jsx)(x.Dialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(x.DialogContent,{className:"sm:max-w-[425px]",children:[(0,s.jsx)(x.DialogHeader,{children:(0,s.jsx)(x.DialogTitle,{children:"Change Password"})}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),(0,s.jsx)(m.Input,{type:"password",value:h.currentPassword,onChange:e=>p({...h,currentPassword:e.target.value}),disabled:i,placeholder:"Enter your current password",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),(0,s.jsx)(m.Input,{type:"password",value:h.newPassword,onChange:e=>p({...h,newPassword:e.target.value}),disabled:i,placeholder:"Enter new password",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),(0,s.jsx)(m.Input,{type:"password",value:h.confirmPassword,onChange:e=>p({...h,confirmPassword:e.target.value}),disabled:i,placeholder:"Confirm new password",required:!0})]}),d&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:d}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:t,disabled:i,children:"Cancel"}),(0,s.jsx)(l.Button,{type:"submit",disabled:i,children:i?"Updating...":"Change Password"})]})]})]})})}var h=e.i(70065),p=e.i(47163);function g({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,p.cn)("w-full caption-bottom text-sm",e),...a})})}function j({className:e,...a}){return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,p.cn)("[&_tr]:border-b",e),...a})}function f({className:e,...a}){return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,p.cn)("[&_tr:last-child]:border-0",e),...a})}function b({className:e,...a}){return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,p.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...a})}function w({className:e,...a}){return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,p.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}function v({className:e,...a}){return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,p.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}function y(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!1),[i,c]=(0,a.useState)(!1),[d,x]=(0,a.useState)(null),[u,p]=(0,a.useState)({name:"",type:"",description:"",bedrooms:1,bathrooms:1,size_sqm:50,price_per_month:"",image_url:""}),y=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,a.useEffect)(()=>{N()},[]);let N=async()=>{try{let{data:e,error:s}=await y.from("apartments").select("*");if(s)return void console.error("Fetch error:",s);t(e||[])}catch(e){console.error("Exception:",e)}},C=async e=>{let s=e.target.files?.[0];if(s){c(!0);try{let e=`${Date.now()}-${s.name}`;console.log("Uploading to bucket: apartments, file:",e);let{error:a,data:t}=await y.storage.from("apartments").upload(e,s);if(a){console.error("Upload error details:",a),alert("Error uploading image: "+a.message),c(!1);return}console.log("Upload successful, data:",t);let{data:r}=y.storage.from("apartments").getPublicUrl(e);console.log("Public URL:",r.publicUrl),p({...u,image_url:r.publicUrl}),alert("Image uploaded successfully!")}catch(e){console.error("Upload exception:",e),alert("Error: "+e)}finally{c(!1)}}},I=async e=>{e.preventDefault(),n(!0);try{let e={name:u.name,type:u.type,description:u.description,bedrooms:parseInt(u.bedrooms.toString())||1,bathrooms:parseInt(u.bathrooms.toString())||1,size_sqm:parseInt(u.size_sqm.toString())||50,price_per_month:parseFloat(u.price_per_month)||0,image_url:u.image_url,is_available:!0};console.log("Inserting apartment:",e);let{error:s}=await y.from("apartments").insert([e]);if(s){console.error("Insert error:",s),alert("Error: "+s.message),n(!1);return}alert("Apartment added successfully!"),k(),await N()}catch(e){console.error("Exception:",e),alert("Error: "+e)}finally{n(!1)}},S=async e=>{if(e.preventDefault(),d){n(!0);try{let e={name:u.name,type:u.type,description:u.description,bedrooms:parseInt(u.bedrooms.toString())||1,bathrooms:parseInt(u.bathrooms.toString())||1,size_sqm:parseInt(u.size_sqm.toString())||50,price_per_month:parseFloat(u.price_per_month)||0,image_url:u.image_url},{error:s}=await y.from("apartments").update(e).eq("id",d);if(s){alert("Error: "+s.message),n(!1);return}alert("Apartment updated successfully!"),k(),await N()}catch(e){console.error("Exception:",e),alert("Error: "+e)}finally{n(!1)}}},_=async e=>{if(confirm("Delete this apartment?"))try{let{error:s}=await y.from("apartments").delete().eq("id",e);if(s)return void alert("Error: "+s.message);alert("Apartment deleted!"),await N()}catch(e){console.error("Error:",e)}},k=()=>{x(null),p({name:"",type:"",description:"",bedrooms:1,bathrooms:1,size_sqm:50,price_per_month:"",image_url:""})};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)(h.Card,{children:[(0,s.jsx)(h.CardHeader,{children:(0,s.jsx)(h.CardTitle,{children:d?"Edit Apartment":"Add New Apartment"})}),(0,s.jsx)(h.CardContent,{children:(0,s.jsxs)("form",{onSubmit:d?S:I,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(m.Input,{placeholder:"Apartment Name",value:u.name,onChange:e=>p({...u,name:e.target.value}),required:!0}),(0,s.jsx)(m.Input,{placeholder:"Type (Studio, 1BR, 2BR)",value:u.type,onChange:e=>p({...u,type:e.target.value}),required:!0}),(0,s.jsx)(m.Input,{placeholder:"Bedrooms",type:"number",value:u.bedrooms,onChange:e=>p({...u,bedrooms:parseInt(e.target.value)||1})}),(0,s.jsx)(m.Input,{placeholder:"Bathrooms",type:"number",value:u.bathrooms,onChange:e=>p({...u,bathrooms:parseInt(e.target.value)||1})}),(0,s.jsx)(m.Input,{placeholder:"Size (sqm)",type:"number",value:u.size_sqm,onChange:e=>p({...u,size_sqm:parseInt(e.target.value)||50})}),(0,s.jsx)(m.Input,{placeholder:"Price per Month",type:"number",value:u.price_per_month,onChange:e=>p({...u,price_per_month:e.target.value}),required:!0})]}),(0,s.jsx)("textarea",{placeholder:"Description",className:"w-full p-2 border rounded",value:u.description,onChange:e=>p({...u,description:e.target.value})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload Image"}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:C,disabled:i,className:"w-full p-2 border rounded"}),i&&(0,s.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Uploading..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Or paste Image URL"}),(0,s.jsx)(m.Input,{placeholder:"https://example.com/image.jpg",value:u.image_url,onChange:e=>p({...u,image_url:e.target.value})}),u.image_url&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm text-green-600",children:"Preview:"}),(0,s.jsx)("img",{src:u.image_url,alt:"Preview",className:"w-32 h-24 object-cover rounded mt-1"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.Button,{type:"submit",disabled:r||i,className:"flex-1",children:r?"Processing...":d?"Update Apartment":"Add Apartment"}),d&&(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:k,children:"Cancel"})]})]})})]}),(0,s.jsxs)(h.Card,{children:[(0,s.jsx)(h.CardHeader,{children:(0,s.jsxs)(h.CardTitle,{children:["All Apartments (",e.length,")"]})}),(0,s.jsx)(h.CardContent,{children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsxs)(b,{children:[(0,s.jsx)(w,{children:"Image"}),(0,s.jsx)(w,{children:"Name"}),(0,s.jsx)(w,{children:"Type"}),(0,s.jsx)(w,{children:"Bedrooms"}),(0,s.jsx)(w,{children:"Price"}),(0,s.jsx)(w,{children:"Actions"})]})}),(0,s.jsx)(f,{children:e.map(e=>(0,s.jsxs)(b,{children:[(0,s.jsx)(v,{children:e.image_url&&(0,s.jsx)("img",{src:e.image_url,alt:e.name,className:"w-16 h-12 object-cover rounded"})}),(0,s.jsx)(v,{children:e.name}),(0,s.jsx)(v,{children:e.type}),(0,s.jsx)(v,{children:e.bedrooms}),(0,s.jsxs)(v,{children:["$",e.price_per_month]}),(0,s.jsxs)(v,{className:"space-x-2",children:[(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>{x(e.id),p({name:e.name,type:e.type,description:e.description,bedrooms:e.bedrooms,bathrooms:e.bathrooms,size_sqm:e.size_sqm,price_per_month:e.price_per_month.toString(),image_url:e.image_url||""}),window.scrollTo({top:0,behavior:"smooth"})},children:"Edit"}),(0,s.jsx)(l.Button,{variant:"destructive",size:"sm",onClick:()=>_(e.id),children:"Delete"})]})]},e.id))})]})})})]})]})}var N=e.i(62870),C=e.i(30009),I=e.i(75254);let S=(0,I.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),_=(0,I.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var k=e.i(7233);let A=(0,I.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function T(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[i,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[j,f]=(0,a.useState)(null),[b,w]=(0,a.useState)({username:"",password:"",full_name:"",email:"",phone:"",position:"",department:"",hire_date:"",status:"active"}),v=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,a.useEffect)(()=>{y()},[]);let y=async()=>{n(!0);try{let{data:e,error:s}=await v.from("employees").select("*").order("created_at",{ascending:!1});s?console.error("Error fetching employees:",s):t(e||[])}catch(e){console.error("Error:",e)}n(!1)},I=e=>{e?(f(e),w({username:e.username,password:e.password,full_name:e.full_name,email:e.email||"",phone:e.phone||"",position:e.position||"",department:e.department||"",hire_date:e.hire_date||"",status:e.status||"active"})):(f(null),w({username:"",password:"",full_name:"",email:"",phone:"",position:"",department:"",hire_date:"",status:"active"})),u(!0)},T=async()=>{if(!b.username||!b.full_name)return void alert("Please fill in required fields");try{if(j){let{error:e}=await v.from("employees").update({...b,updated_at:new Date().toISOString()}).eq("id",j.id);if(e)return void alert("Error updating employee: "+e.message)}else{let{error:e}=await v.from("employees").insert([b]);if(e)return void alert("Error adding employee: "+e.message)}u(!1),await y()}catch(e){alert("An error occurred")}},D=async()=>{try{let{error:e}=await v.from("employees").delete().eq("id",j.id);if(e)return void alert("Error deleting employee: "+e.message);g(!1),await y()}catch(e){alert("An error occurred")}},P=e.filter(e=>`${e.full_name} ${e.username} ${e.email||""}`.toLowerCase().includes(i.toLowerCase()));return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Employees Management"}),(0,s.jsxs)(l.Button,{onClick:()=>I(),className:"flex items-center gap-2",children:[(0,s.jsx)(k.Plus,{className:"h-4 w-4"}),"Add Employee"]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(A,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)(m.Input,{placeholder:"Search by name, username, or email...",value:i,onChange:e=>c(e.target.value),className:"pl-10"})]}),(0,s.jsx)(h.Card,{children:(0,s.jsx)(h.CardContent,{className:"pt-6",children:r?(0,s.jsx)("div",{className:"text-center py-8",children:"Loading employees..."}):0===P.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No employees found"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Name"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Username"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Password"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Email"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Position"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Department"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Status"}),(0,s.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:P.map(e=>(0,s.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"py-3 px-4 font-medium",children:e.full_name}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600",children:e.username}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm font-mono bg-gray-100 px-2 py-1 rounded max-w-xs",children:e.password||"-"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm",children:e.email||"-"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm",children:e.position||"-"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm",children:e.department||"-"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm",children:(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${"active"===e.status?"bg-green-100 text-green-800":"on-leave"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.status})}),(0,s.jsxs)("td",{className:"py-3 px-4 text-right space-x-2",children:[(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>I(e),children:(0,s.jsx)(S,{className:"h-4 w-4"})}),(0,s.jsx)(l.Button,{variant:"destructive",size:"sm",onClick:()=>{f(e),g(!0)},children:(0,s.jsx)(_,{className:"h-4 w-4"})})]})]},e.id))})]})})})}),(0,s.jsx)(x.Dialog,{open:d,onOpenChange:u,children:(0,s.jsxs)(x.DialogContent,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)(x.DialogHeader,{children:(0,s.jsx)(x.DialogTitle,{children:j?"Edit Employee":"Add New Employee"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Username *"}),(0,s.jsx)(m.Input,{value:b.username,onChange:e=>w({...b,username:e.target.value}),placeholder:"Username",disabled:!!j,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Password ",j&&"(leave blank to keep current)"]}),(0,s.jsx)(m.Input,{type:"password",value:b.password,onChange:e=>w({...b,password:e.target.value}),placeholder:"Password",required:!j})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),(0,s.jsx)(m.Input,{value:b.full_name,onChange:e=>w({...b,full_name:e.target.value}),placeholder:"Full name",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email"}),(0,s.jsx)(m.Input,{type:"email",value:b.email,onChange:e=>w({...b,email:e.target.value}),placeholder:"Email"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),(0,s.jsx)(m.Input,{value:b.phone,onChange:e=>w({...b,phone:e.target.value}),placeholder:"Phone number"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Position"}),(0,s.jsxs)(N.Select,{value:b.position,onValueChange:e=>w({...b,position:e}),children:[(0,s.jsx)(N.SelectTrigger,{children:(0,s.jsx)(N.SelectValue,{placeholder:"Select position"})}),(0,s.jsx)(N.SelectContent,{children:["Manager","Supervisor","Technician","Staff","Intern"].map(e=>(0,s.jsx)(N.SelectItem,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Department"}),(0,s.jsxs)(N.Select,{value:b.department,onValueChange:e=>w({...b,department:e}),children:[(0,s.jsx)(N.SelectTrigger,{children:(0,s.jsx)(N.SelectValue,{placeholder:"Select department"})}),(0,s.jsx)(N.SelectContent,{children:["IT","Maintenance","Security","Administration","Cleaning"].map(e=>(0,s.jsx)(N.SelectItem,{value:e,children:e},e))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Hire Date"}),(0,s.jsx)(m.Input,{type:"date",value:b.hire_date,onChange:e=>w({...b,hire_date:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Status"}),(0,s.jsxs)(N.Select,{value:b.status,onValueChange:e=>w({...b,status:e}),children:[(0,s.jsx)(N.SelectTrigger,{children:(0,s.jsx)(N.SelectValue,{})}),(0,s.jsx)(N.SelectContent,{children:["active","inactive","on-leave"].map(e=>(0,s.jsx)(N.SelectItem,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ")},e))})]})]})]})]}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),(0,s.jsxs)(l.Button,{onClick:T,children:[j?"Update":"Add"," Employee"]})]})]})}),(0,s.jsx)(C.AlertDialog,{open:p,onOpenChange:g,children:(0,s.jsxs)(C.AlertDialogContent,{children:[(0,s.jsx)(C.AlertDialogTitle,{children:"Delete Employee"}),(0,s.jsxs)(C.AlertDialogDescription,{children:["Are you sure you want to delete ",j?.full_name,"? This action cannot be undone."]}),(0,s.jsxs)(C.AlertDialogFooter,{children:[(0,s.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,s.jsx)(C.AlertDialogAction,{onClick:D,className:"bg-red-600",children:"Delete"})]})]})})]})}function D(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[i,c]=(0,a.useState)(null),d=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,a.useEffect)(()=>{m()},[]);let m=async()=>{try{console.log("Fetching bookings...");let{data:e,error:s}=await d.from("bookings").select("*").order("created_at",{ascending:!1});if(console.log("Bookings data:",{data:e,error:s}),s){console.error("Fetch error:",s),n(!1);return}t(e||[])}catch(e){console.error("Exception:",e)}finally{n(!1)}},x=async(e,s)=>{try{let{error:a}=await d.from("bookings").update({status:s}).eq("id",e);if(a)return void alert("Error updating status: "+a.message);alert("Status updated!"),await m()}catch(e){console.error("Error:",e)}},u=async e=>{if(window.confirm("Are you sure you want to delete this booking? This action cannot be undone.")){c(e);try{let{error:s}=await d.from("bookings").delete().eq("id",e);if(s){alert("Error deleting booking: "+s.message),c(null);return}alert("Booking deleted successfully!"),await m()}catch(e){console.error("Error:",e),alert("An error occurred while deleting the booking"),c(null)}}};return(0,s.jsxs)(h.Card,{children:[(0,s.jsx)(h.CardHeader,{children:(0,s.jsxs)(h.CardTitle,{children:["All Bookings (",e.length,")"]})}),(0,s.jsx)(h.CardContent,{children:r?(0,s.jsx)("p",{children:"Loading bookings..."}):0===e.length?(0,s.jsx)("p",{className:"text-gray-500",children:"No bookings yet"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsxs)(b,{children:[(0,s.jsx)(w,{children:"Client Name"}),(0,s.jsx)(w,{children:"Email"}),(0,s.jsx)(w,{children:"Phone"}),(0,s.jsx)(w,{children:"Apartment Type"}),(0,s.jsx)(w,{children:"Move-in Date"}),(0,s.jsx)(w,{children:"Move-out Date"}),(0,s.jsx)(w,{children:"Status"}),(0,s.jsx)(w,{children:"Action"})]})}),(0,s.jsx)(f,{children:e.map(e=>(0,s.jsxs)(b,{children:[(0,s.jsx)(v,{children:e.client_name}),(0,s.jsx)(v,{children:e.email}),(0,s.jsx)(v,{children:e.phone_number}),(0,s.jsx)(v,{children:e.apartment_type}),(0,s.jsx)(v,{children:new Date(e.start_date).toLocaleDateString()}),(0,s.jsx)(v,{children:new Date(e.end_date).toLocaleDateString()}),(0,s.jsx)(v,{children:(0,s.jsx)("span",{className:`px-2 py-1 rounded text-sm ${"confirmed"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:e.status})}),(0,s.jsxs)(v,{className:"space-x-2",children:[(0,s.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>x(e.id,"confirmed"),children:"Confirm"}),(0,s.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>x(e.id,"rejected"),children:"Reject"}),(0,s.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>u(e.id),disabled:i===e.id,children:i===e.id?"Deleting...":"Delete"})]})]},e.id))})]})})})]})}var P=e.i(95116);function M(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[n,i]=(0,a.useState)(""),[c,d]=(0,a.useState)("all"),x=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,a.useEffect)(()=>{u()},[]);let u=async()=>{l(!0);try{let{data:e}=await x.from("maintenance_requests").select("*").order("created_at",{ascending:!1});e&&t(e)}catch(e){console.error("Error fetching requests:",e)}l(!1)},p=async(e,s)=>{let{error:a}=await x.from("maintenance_requests").update({status:s}).eq("id",e);a||await u()},g=e.filter(e=>{let s=`${e.issue_type||""} ${e.description||""}`.toLowerCase().includes(n.toLowerCase()),a="all"===c||e.status===c;return s&&a});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(P.Wrench,{className:"h-6 w-6"}),"Maintenance Requests"]})}),(0,s.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,s.jsxs)("div",{className:"relative flex-1 min-w-64",children:[(0,s.jsx)(A,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)(m.Input,{placeholder:"Search by issue type or description...",value:n,onChange:e=>i(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(N.Select,{value:c,onValueChange:d,children:[(0,s.jsx)(N.SelectTrigger,{className:"w-40",children:(0,s.jsx)(N.SelectValue,{})}),(0,s.jsxs)(N.SelectContent,{children:[(0,s.jsx)(N.SelectItem,{value:"all",children:"All Status"}),(0,s.jsx)(N.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(N.SelectItem,{value:"in-progress",children:"In Progress"}),(0,s.jsx)(N.SelectItem,{value:"completed",children:"Completed"})]})]})]}),(0,s.jsx)("div",{className:"grid gap-4",children:r?(0,s.jsx)("div",{className:"text-center py-8",children:"Loading requests..."}):0===g.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No maintenance requests found"}):g.map(e=>(0,s.jsx)(h.Card,{children:(0,s.jsxs)(h.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:e.issue_type}),(0,s.jsx)("p",{className:"text-gray-700 mt-2",children:e.description}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Requested: ",new Date(e.created_at).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:`text-xs font-semibold px-2 py-1 rounded ${(e=>{switch(e){case"completed":return"text-green-600 bg-green-50";case"in-progress":return"text-blue-600 bg-blue-50";case"pending":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}})(e.status)}`,children:e.status.toUpperCase()})})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(N.Select,{value:e.status,onValueChange:s=>p(e.id,s),children:[(0,s.jsx)(N.SelectTrigger,{className:"w-40",children:(0,s.jsx)(N.SelectValue,{})}),(0,s.jsxs)(N.SelectContent,{children:[(0,s.jsx)(N.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(N.SelectItem,{value:"in-progress",children:"In Progress"}),(0,s.jsx)(N.SelectItem,{value:"completed",children:"Completed"})]})]})})]})},e.id))})]})}function E(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(null),i=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,a.useEffect)(()=>{c()},[]);let c=async()=>{let{data:e}=await i.from("client_feedback").select("*").order("created_at",{ascending:!1});e&&t(e)},d=async e=>{if(window.confirm("Are you sure you want to delete this feedback? This action cannot be undone.")){n(e);try{let{error:s}=await i.from("client_feedback").delete().eq("id",e);if(s){alert("Error deleting feedback: "+s.message),n(null);return}alert("Feedback deleted successfully!"),await c()}catch(e){console.error("Error:",e),alert("An error occurred while deleting the feedback"),n(null)}}};return(0,s.jsxs)(h.Card,{children:[(0,s.jsxs)(h.CardHeader,{children:[(0,s.jsx)(h.CardTitle,{children:"Client Feedback"}),(0,s.jsx)(h.CardDescription,{children:"View all feedback and reviews from clients"})]}),(0,s.jsx)(h.CardContent,{children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsxs)(b,{children:[(0,s.jsx)(w,{children:"Name"}),(0,s.jsx)(w,{children:"Email"}),(0,s.jsx)(w,{children:"Message"}),(0,s.jsx)(w,{children:"Rating"}),(0,s.jsx)(w,{children:"Date"}),(0,s.jsx)(w,{children:"Action"})]})}),(0,s.jsx)(f,{children:0===e.length?(0,s.jsx)(b,{children:(0,s.jsx)(v,{colSpan:6,className:"text-center text-muted-foreground",children:"No feedback yet"})}):e.map(e=>(0,s.jsxs)(b,{children:[(0,s.jsx)(v,{children:e.name}),(0,s.jsx)(v,{children:e.email}),(0,s.jsx)(v,{className:"max-w-xs truncate",children:e.message}),(0,s.jsx)(v,{children:"⭐".repeat(e.rating)}),(0,s.jsx)(v,{children:new Date(e.created_at).toLocaleDateString()}),(0,s.jsx)(v,{children:(0,s.jsx)(l.Button,{size:"sm",variant:"destructive",onClick:()=>d(e.id),disabled:r===e.id,children:r===e.id?"Deleting...":"Delete"})})]},e.id))})]})})})]})}var J=e.i(69638),B=e.i(73884),q=e.i(3116),z=e.i(84614),U=e.i(63488),O=e.i(43432),X=e.i(78583),R=e.i(63209);function F(){let[e,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),[i,c]=(0,a.useState)(!0),[d,x]=(0,a.useState)("pending"),[u,p]=(0,a.useState)(null),[g,j]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),[w,v]=(0,a.useState)(""),y=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,a.useEffect)(()=>{let e=localStorage.getItem("admin_session");e&&t(JSON.parse(e))},[]),(0,a.useEffect)(()=>{e&&(async()=>{try{c(!0);let e=y.from("tenants").select("*").order("created_at",{ascending:!1});"all"!==d&&(e=e.eq("approval_status",d));let{data:s,error:a}=await e;if(a)return void console.error("Error fetching tenants:",a);n(s||[])}catch(e){console.error("Error:",e)}finally{c(!1)}})()},[e,d]);let N=async()=>{if(u&&e)try{let{error:s}=await y.from("tenants").update({approval_status:"approved",is_active:!0,approved_by:e.id,approved_at:new Date().toISOString()}).eq("id",u.id);if(s)return void console.error("Error approving tenant:",s);n(r.map(e=>e.id===u.id?{...e,approval_status:"approved",is_active:!0}:e)),b(!1),p(null),j(null)}catch(e){console.error("Error:",e)}},I=async()=>{if(u&&e)try{let{error:s}=await y.from("tenants").update({approval_status:"rejected",is_active:!1,approved_by:e.id,approved_at:new Date().toISOString()}).eq("id",u.id);if(s)return void console.error("Error rejecting tenant:",s);n(r.map(e=>e.id===u.id?{...e,approval_status:"rejected",is_active:!1}:e)),b(!1),p(null),j(null)}catch(e){console.error("Error:",e)}},S=async()=>{if(u&&e)try{let{error:e}=await y.from("tenants").delete().eq("id",u.id);if(e)return void console.error("Error deleting tenant:",e);n(r.filter(e=>e.id!==u.id)),b(!1),p(null),j(null)}catch(e){console.error("Error:",e)}},k=r.filter(e=>{let s=w.toLowerCase();return e.full_name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.username.toLowerCase().includes(s)});return i?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading tenants..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tenant Management"}),(0,s.jsx)("p",{className:"text-gray-600",children:"View and approve tenant account requests"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(m.Input,{placeholder:"Search by name, email, or username...",value:w,onChange:e=>v(e.target.value),className:"max-w-md"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:["pending","approved","rejected","all"].map(e=>(0,s.jsxs)(l.Button,{variant:d===e?"default":"outline",onClick:()=>x(e),className:d===e?"bg-blue-600 hover:bg-blue-700":"border-gray-300",children:[e.charAt(0).toUpperCase()+e.slice(1),(0,s.jsxs)("span",{className:"ml-2 text-xs font-semibold",children:["(",r.filter(s=>"all"===e||s.approval_status===e).length,")"]})]},e))})]}),0===k.length?(0,s.jsx)(h.Card,{children:(0,s.jsxs)(h.CardContent,{className:"pt-8 text-center",children:[(0,s.jsx)(R.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsxs)("p",{className:"text-gray-500 text-lg",children:["No ","all"===d?"":d," tenant requests found"]})]})}):(0,s.jsx)("div",{className:"grid gap-4",children:k.map(e=>(0,s.jsx)(h.Card,{className:"hover:shadow-lg transition-shadow",children:(0,s.jsx)(h.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between gap-6",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.full_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["@",e.username]}),(0,s.jsxs)("div",{className:`inline-flex items-center gap-2 mt-3 px-3 py-1 rounded-full text-sm font-semibold border ${(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"approved":return"bg-green-100 text-green-800 border-green-300";case"rejected":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}})(e.approval_status)}`,children:[(e=>{switch(e){case"pending":return(0,s.jsx)(q.Clock,{className:"h-5 w-5"});case"approved":return(0,s.jsx)(J.CheckCircle,{className:"h-5 w-5"});case"rejected":return(0,s.jsx)(B.XCircle,{className:"h-5 w-5"});default:return null}})(e.approval_status),e.approval_status.charAt(0).toUpperCase()+e.approval_status.slice(1)]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(U.Mail,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Email"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.email})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(O.Phone,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Phone"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.phone})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(X.FileText,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"ID Number"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.id_number})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(z.User,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Emergency Contact"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.emergency_contact})]})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Address"}),(0,s.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.address,", ",e.city,", ",e.country]})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Emergency Contact Phone"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.emergency_contact_phone})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Password"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 font-mono bg-gray-100 px-2 py-1 rounded",children:e.password})]})]})]}),"pending"===e.approval_status&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 lg:justify-center",children:[(0,s.jsxs)(l.Button,{onClick:()=>{p(e),j("approve"),b(!0)},className:"bg-green-600 hover:bg-green-700 text-white gap-2",children:[(0,s.jsx)(J.CheckCircle,{className:"h-4 w-4"}),"Approve"]}),(0,s.jsxs)(l.Button,{onClick:()=>{p(e),j("reject"),b(!0)},variant:"destructive",className:"gap-2",children:[(0,s.jsx)(B.XCircle,{className:"h-4 w-4"}),"Reject"]}),(0,s.jsxs)(l.Button,{onClick:()=>{p(e),j("delete"),b(!0)},variant:"outline",className:"gap-2 text-red-600 border-red-300 hover:bg-red-50",children:[(0,s.jsx)(_,{className:"h-4 w-4"}),"Delete"]})]}),"approved"===e.approval_status&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 lg:justify-center",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-green-700 bg-green-50 px-4 py-2 rounded-lg text-center",children:"✓ Account Active"}),(0,s.jsxs)(l.Button,{onClick:()=>{p(e),j("delete"),b(!0)},variant:"outline",className:"gap-2 text-red-600 border-red-300 hover:bg-red-50",children:[(0,s.jsx)(_,{className:"h-4 w-4"}),"Delete"]})]}),"rejected"===e.approval_status&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 lg:justify-center",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-red-700 bg-red-50 px-4 py-2 rounded-lg text-center",children:"✗ Account Rejected"}),(0,s.jsxs)(l.Button,{onClick:()=>{p(e),j("delete"),b(!0)},variant:"outline",className:"gap-2 text-red-600 border-red-300 hover:bg-red-50",children:[(0,s.jsx)(_,{className:"h-4 w-4"}),"Delete"]})]})]})})},e.id))}),(0,s.jsx)(C.AlertDialog,{open:f,onOpenChange:b,children:(0,s.jsxs)(C.AlertDialogContent,{children:[(0,s.jsxs)(C.AlertDialogHeader,{children:[(0,s.jsx)(C.AlertDialogTitle,{children:"approve"===g?"Approve Tenant Account?":"reject"===g?"Reject Tenant Account?":"Delete Tenant Account?"}),(0,s.jsx)(C.AlertDialogDescription,{children:"approve"===g?`Are you sure you want to approve ${u?.full_name}'s account? They will be able to login immediately.`:"reject"===g?`Are you sure you want to reject ${u?.full_name}'s account? They will be notified.`:`Are you sure you want to delete ${u?.full_name}'s account? This action cannot be undone.`})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,s.jsx)(C.AlertDialogAction,{onClick:"approve"===g?N:"reject"===g?I:S,className:"approve"===g?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:"approve"===g?"Approve":"reject"===g?"Reject":"Delete"})]})]})})]})}let L=(0,I.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function V(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1),[N,I]=(0,a.useState)(""),[S,A]=(0,a.useState)(""),[T,D]=(0,a.useState)(null),[P,M]=(0,a.useState)({username:"",password:"",confirmPassword:"",full_name:""}),[E,J]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[B,q]=(0,a.useState)(""),[z,U]=(0,a.useState)(""),[O,X]=(0,a.useState)(""),[R,F]=(0,a.useState)(""),[V,Z]=(0,a.useState)(!1),[H,Y]=(0,a.useState)(!1),G=(0,o.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q"),K=async()=>{try{n(!0);let{data:e,error:s}=await G.from("admin_accounts").select("*").order("created_at",{ascending:!1});if(s&&s.message){console.error("Error fetching admins:",s.message),q("Failed to load admins");return}t(e||[])}catch(e){console.error("Error:",e),q("An error occurred while fetching admins")}finally{n(!1)}};(0,a.useEffect)(()=>{K()},[]);let W=e=>{let{name:s,value:a}=e.target;M(e=>({...e,[s]:a}))},Q=e=>{let{name:s,value:a}=e.target;J(e=>({...e,[s]:a}))},$=async e=>{if(e.preventDefault(),(q(""),P.username.trim())?P.username.length<3?(q("Username must be at least 3 characters"),!1):P.password?P.password.length<6?(q("Password must be at least 6 characters"),!1):P.password!==P.confirmPassword?(q("Passwords do not match"),!1):!!P.full_name.trim()||(q("Full name is required"),!1):(q("Password is required"),!1):(q("Username is required"),!1))try{Z(!0),q("");let{data:e}=await G.from("admin_accounts").select("id").eq("username",P.username).single();if(e){q("Username already exists"),Z(!1);return}let{error:s}=await G.from("admin_accounts").insert([{username:P.username,password:P.password,full_name:P.full_name}]);if(s&&s.message){console.error("Error adding admin:",s.message),q("Failed to add admin account"),Z(!1);return}U("Admin account created successfully!"),M({username:"",password:"",confirmPassword:"",full_name:""}),setTimeout(()=>{c(!1),U(""),K()},1500)}catch(e){console.error("Error:",e),q("An error occurred while creating the admin account")}finally{Z(!1)}},ee=async e=>{if(e.preventDefault(),(X(""),E.currentPassword)?E.newPassword?E.newPassword.length<6?(X("Password must be at least 6 characters"),!1):E.newPassword===E.confirmPassword||(X("Passwords do not match"),!1):(X("New password is required"),!1):(X("Current password is required"),!1))try{Y(!0),X("");let{data:e}=await G.from("settings").select("setting_value").eq("setting_key","master_deletion_password").single();if(!e||e.setting_value!==E.currentPassword){X("Current password is incorrect"),Y(!1);return}let{error:s}=await G.from("settings").update({setting_value:E.newPassword}).eq("setting_key","master_deletion_password");if(s&&s.message){console.error("Error updating password:",s.message),X("Failed to update password"),Y(!1);return}F("Master deletion password updated successfully!"),J({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{u(!1),F("")},1500)}catch(e){console.error("Error:",e),X("An error occurred while updating the password")}finally{Y(!1)}},es=async()=>{if(T)try{A("");let{data:e}=await G.from("settings").select("setting_value").eq("setting_key","master_deletion_password").single();if(!e||e.setting_value!==N)return void A("Incorrect password");let s=localStorage.getItem("admin_session");if(s&&JSON.parse(s).id===T.id)return void A("You cannot delete your own admin account");let{error:a}=await G.from("admin_accounts").delete().eq("id",T.id);if(a&&a.message){console.error("Error deleting admin:",a.message),A("Failed to delete admin");return}U(`Admin "${T.username}" deleted successfully`),setTimeout(()=>{U(""),y(!1),D(null),K()},1500)}catch(e){console.error("Error:",e),A("An error occurred while deleting the admin")}};return r?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:"Loading admins..."}):(0,s.jsxs)("div",{className:"space-y-6",children:[B&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:B}),z&&(0,s.jsxs)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:["✓ ",z]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)(x.Dialog,{open:d,onOpenChange:u,children:[(0,s.jsx)(x.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(l.Button,{variant:"outline",className:"gap-2",children:[(0,s.jsx)(L,{className:"h-4 w-4"}),"Settings"]})}),(0,s.jsxs)(x.DialogContent,{children:[(0,s.jsx)(x.DialogHeader,{children:(0,s.jsx)(x.DialogTitle,{children:"Change Master Deletion Password"})}),(0,s.jsxs)("form",{onSubmit:ee,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),(0,s.jsx)(m.Input,{type:"password",name:"currentPassword",value:E.currentPassword,onChange:Q,placeholder:"Enter current password",disabled:H})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),(0,s.jsx)(m.Input,{type:"password",name:"newPassword",value:E.newPassword,onChange:Q,placeholder:"Enter new password",disabled:H})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),(0,s.jsx)(m.Input,{type:"password",name:"confirmPassword",value:E.confirmPassword,onChange:Q,placeholder:"Confirm new password",disabled:H})]}),O&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:O}),R&&(0,s.jsx)("div",{className:"text-green-500 text-sm",children:R}),(0,s.jsx)(l.Button,{type:"submit",disabled:H,className:"w-full bg-blue-600 hover:bg-blue-700",children:H?"Updating...":"Update Password"})]})]})]}),(0,s.jsxs)(x.Dialog,{open:i,onOpenChange:c,children:[(0,s.jsx)(x.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(l.Button,{className:"gap-2 bg-blue-600 hover:bg-blue-700",children:[(0,s.jsx)(k.Plus,{className:"h-4 w-4"}),"Add New Admin"]})}),(0,s.jsxs)(x.DialogContent,{children:[(0,s.jsx)(x.DialogHeader,{children:(0,s.jsx)(x.DialogTitle,{children:"Add New Admin Account"})}),(0,s.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Username"}),(0,s.jsx)(m.Input,{type:"text",name:"username",value:P.username,onChange:W,placeholder:"Enter username",disabled:V})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),(0,s.jsx)(m.Input,{type:"text",name:"full_name",value:P.full_name,onChange:W,placeholder:"Enter full name",disabled:V})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Password"}),(0,s.jsx)(m.Input,{type:"password",name:"password",value:P.password,onChange:W,placeholder:"Enter password",disabled:V})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm Password"}),(0,s.jsx)(m.Input,{type:"password",name:"confirmPassword",value:P.confirmPassword,onChange:W,placeholder:"Confirm password",disabled:V})]}),B&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:B}),z&&(0,s.jsx)("div",{className:"text-green-500 text-sm",children:z}),(0,s.jsx)(l.Button,{type:"submit",disabled:V,className:"w-full bg-blue-600 hover:bg-blue-700",children:V?"Creating...":"Create Admin"})]})]})]})]}),(0,s.jsxs)(h.Card,{children:[(0,s.jsx)(h.CardHeader,{children:(0,s.jsxs)(h.CardTitle,{children:["Admin Accounts (",e.length,")"]})}),(0,s.jsx)(h.CardContent,{children:0===e.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No admins found"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsxs)(b,{children:[(0,s.jsx)(w,{children:"Username"}),(0,s.jsx)(w,{children:"Full Name"}),(0,s.jsx)(w,{children:"Created"}),(0,s.jsx)(w,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(f,{children:e.map(e=>(0,s.jsxs)(b,{children:[(0,s.jsx)(v,{className:"font-medium",children:e.username}),(0,s.jsx)(v,{children:e.full_name||"-"}),(0,s.jsx)(v,{children:new Date(e.created_at).toLocaleDateString()}),(0,s.jsx)(v,{className:"text-right",children:(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{D(e),I(""),A(""),y(!0)},children:(0,s.jsx)(_,{className:"h-4 w-4"})})})]},e.id))})]})})})]}),(0,s.jsx)(C.AlertDialog,{open:p,onOpenChange:y,children:(0,s.jsxs)(C.AlertDialogContent,{children:[(0,s.jsxs)(C.AlertDialogHeader,{children:[(0,s.jsx)(C.AlertDialogTitle,{children:"Delete Admin Account"}),(0,s.jsxs)(C.AlertDialogDescription,{children:['Enter the master deletion password to confirm deletion of admin "',T?.username,'". This action cannot be undone.']})]}),(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsx)(m.Input,{type:"password",placeholder:"Enter master deletion password",value:N,onChange:e=>{I(e.target.value),A("")},className:"mb-2"}),S&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:S})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,s.jsx)(C.AlertDialogAction,{onClick:es,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}var Z=e.i(42920),H=e.i(61911),Y=e.i(87316),G=e.i(86311),K=e.i(34161),W=e.i(94351),Q=e.i(86536);let $=(0,I.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);function ee(){let e=(0,t.useRouter)(),[n,i]=(0,a.useState)(null),[o,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let s=localStorage.getItem("admin_session");if(!s)return void e.push("/login?redirect=admin");try{i(JSON.parse(s))}catch(s){e.push("/login?redirect=admin")}g(!1)},[e]),p)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):n?(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)(d,{admin:n,onLogout:()=>{localStorage.removeItem("admin_session"),e.push("/login")}}),(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"Dashboard"}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:["Welcome back, ",n.username,"!"]})]}),(0,s.jsxs)(l.Button,{onClick:()=>m(!0),variant:"outline",className:"flex items-center gap-2",children:[(0,s.jsx)(K.Key,{className:"h-4 w-4"}),"Change Password"]})]}),x&&(0,s.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6",children:"✓ Password changed successfully!"}),(0,s.jsxs)(r.Tabs,{defaultValue:"apartments",className:"space-y-8",children:[(0,s.jsxs)(r.TabsList,{className:"grid w-full grid-cols-7 lg:w-auto",children:[(0,s.jsxs)(r.TabsTrigger,{value:"apartments",className:"flex items-center gap-2",children:[(0,s.jsx)(Z.Building,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Apartments"})]}),(0,s.jsxs)(r.TabsTrigger,{value:"tenants",className:"flex items-center gap-2",children:[(0,s.jsx)(W.Home,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Tenants"})]}),(0,s.jsxs)(r.TabsTrigger,{value:"employees",className:"flex items-center gap-2",children:[(0,s.jsx)(H.Users,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Employees"})]}),(0,s.jsxs)(r.TabsTrigger,{value:"admins",className:"flex items-center gap-2",children:[(0,s.jsx)($,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Admins"})]}),(0,s.jsxs)(r.TabsTrigger,{value:"bookings",className:"flex items-center gap-2",children:[(0,s.jsx)(Y.Calendar,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Bookings"})]}),(0,s.jsxs)(r.TabsTrigger,{value:"maintenance",className:"flex items-center gap-2",children:[(0,s.jsx)(P.Wrench,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Maintenance"})]}),(0,s.jsxs)(r.TabsTrigger,{value:"feedback",className:"flex items-center gap-2",children:[(0,s.jsx)(G.MessageSquare,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]})]}),(0,s.jsx)(r.TabsContent,{value:"apartments",children:(0,s.jsx)(y,{})}),(0,s.jsx)(r.TabsContent,{value:"tenants",children:(0,s.jsx)(F,{})}),(0,s.jsx)(r.TabsContent,{value:"employees",children:(0,s.jsx)(T,{})}),(0,s.jsx)(r.TabsContent,{value:"admins",children:(0,s.jsx)(V,{})}),(0,s.jsx)(r.TabsContent,{value:"bookings",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsx)(l.Button,{asChild:!0,className:"gap-2 bg-blue-600 hover:bg-blue-700",children:(0,s.jsxs)(c.default,{href:"/admin/bookings",children:[(0,s.jsx)(Q.Eye,{className:"h-4 w-4"}),"View All Bookings"]})})}),(0,s.jsx)(D,{})]})}),(0,s.jsx)(r.TabsContent,{value:"maintenance",children:(0,s.jsx)(M,{})}),(0,s.jsx)(r.TabsContent,{value:"feedback",children:(0,s.jsx)(E,{})})]})]}),(0,s.jsx)(u,{isOpen:o,onClose:()=>m(!1),adminId:n.id,onSuccess:()=>{h(!0),setTimeout(()=>h(!1),3e3)}})]}):null}e.s(["default",()=>ee],20383)}]);