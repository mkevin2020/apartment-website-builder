module.exports=[49816,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(35025);var e=a.i(9701),f=a.i(40695),g=a.i(3130),h=a.i(5522),i=a.i(51513),j=a.i(14414),k=a.i(84505),l=a.i(4720),m=a.i(79808),n=a.i(11156),o=a.i(24987),p=a.i(41675),q=a.i(16201),r=a.i(92e3),s=a.i(81010),t=a.i(90166),u=a.i(50778),v=a.i(16286),w=a.i(34044),x=a.i(15618),y=a.i(81402),z=a.i(38246);function A(){let a=(0,d.useRouter)(),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)(!0),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)({apartment_id:0,start_date:"",end_date:""}),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(!1),Y=(0,e.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");if((0,c.useEffect)(()=>{(async()=>{try{let b=localStorage.getItem("tenant_session");if(!b)return void a.push("/login");let c=JSON.parse(b);B(c);let{data:d,error:e}=await Y.from("bookings").select("*").eq("tenant_id",String(c.id)).order("start_date",{ascending:!1}).limit(1);if(e&&e.message&&console.error("Error fetching booking:",e.message),d&&d.length>0){let a=d[0];D(a);let{data:b,error:c}=await Y.from("apartments").select("*").eq("id",a.apartment_id).single();c&&c.message&&console.error("Error fetching apartment:",c.message),b&&F(b)}let{data:f,error:g}=await Y.from("apartments").select("*").eq("is_available",!0).order("price_per_month",{ascending:!0});g&&g.message?console.error("Error fetching available apartments:",g.message):f&&H(f)}catch(a){console.error("Error in fetchTenantData:",a),L("Failed to load dashboard data")}finally{J(!1)}})()},[a,Y]),I)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})});if(!A)return null;let Z=async a=>{if(!M.start_date||!M.end_date)return void T("Please fill in all booking dates");if(new Date(M.start_date)>=new Date(M.end_date))return void T("End date must be after start date");P(!0),T(null);try{let b=G.find(b=>b.id===a);if(!b)return void T("Apartment not found");let c={tenant_id:String(A.id),apartment_id:a,start_date:M.start_date,end_date:M.end_date,status:"pending",client_name:A.full_name,email:A.email,phone_number:A.phone||"",apartment_type:b.name},{data:d,error:e}=await Y.from("bookings").insert([c]).select();if(e){console.error("Booking error:",e),e.message?.includes("apartment_id")?T("Database configuration issue: The booking system needs to be initialized. Please contact support."):T(`Failed to book apartment: ${e.message}`);return}if(!d||0===d.length)return void T("Booking failed. Please try again.");R("Apartment booked successfully! Check your booked apartments."),N({apartment_id:0,start_date:"",end_date:""}),V(!1),setTimeout(()=>{window.location.reload()},2e3)}catch(a){console.error("Error booking apartment:",a),T("An error occurred while booking the apartment")}finally{P(!1)}};return K?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,b.jsxs)("div",{className:"text-center max-w-md",children:[(0,b.jsx)(r.AlertCircle,{className:"h-16 w-16 text-red-600 mx-auto mb-4"}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Error"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:K}),(0,b.jsx)(f.Button,{onClick:()=>window.location.reload(),children:"Try Again"})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{tenant:A}),(0,b.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8 flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:["Welcome back, ",A.full_name,"! ðŸ‘‹"]}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage your apartment and stay updated"})]}),(0,b.jsxs)(f.Button,{onClick:()=>X(!0),variant:"outline",className:"flex items-center gap-2",children:[(0,b.jsx)(y.Key,{className:"h-4 w-4"}),"Change Password"]})]}),E&&(0,b.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 mb-8",children:[(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Monthly Rent"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["$",E.monthly_rent]})]}),(0,b.jsx)(t.DollarSign,{className:"h-10 w-10 text-blue-200"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Bedrooms"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:E.bedrooms})]}),(0,b.jsx)(s.Home,{className:"h-10 w-10 text-purple-200"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Unit Number"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-indigo-600",children:E.unit_number})]}),(0,b.jsx)(o.MapPin,{className:"h-10 w-10 text-indigo-200"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Payment Status"}),(0,b.jsx)("p",{className:"text-2xl font-bold capitalize",children:A.payment_status||"N/A"})]}),(0,b.jsx)("div",{className:`h-10 w-10 rounded-full flex items-center justify-center ${(a=>{switch(a?.toLowerCase()){case"paid":return"bg-green-100 text-green-800 border-green-300";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"overdue":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}})(A.payment_status||"")}`,children:(a=>{switch(a?.toLowerCase()){case"paid":return(0,b.jsx)(q.CheckCircle,{className:"h-5 w-5"});case"overdue":return(0,b.jsx)(r.AlertCircle,{className:"h-5 w-5"});default:return(0,b.jsx)(n.CreditCard,{className:"h-5 w-5"})}})(A.payment_status||"")})]})})})]}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[E?(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Home,{className:"h-5 w-5 text-blue-600"}),"Your Apartment"]})}),(0,b.jsxs)(g.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Apartment Name"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:E.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Unit Number"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:E.unit_number})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Size"}),(0,b.jsxs)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:[E.size," sqft"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Bathrooms"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:E.bathrooms})]})]}),E.description&&(0,b.jsxs)("div",{className:"pt-4 border-t",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Description"}),(0,b.jsx)("p",{className:"text-gray-700 mt-2",children:E.description})]})]})]}):(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No apartment assigned yet"})})}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p.Calendar,{className:"h-5 w-5 text-green-600"}),"Lease Information"]})}),(0,b.jsx)(g.CardContent,{className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Lease Start Date"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:A.lease_start?new Date(A.lease_start).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Lease End Date"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:A.lease_end?new Date(A.lease_end).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})]})]})})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Quick Actions"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-3",children:[(0,b.jsx)(f.Button,{asChild:!0,className:"w-full justify-start gap-2 bg-blue-600 hover:bg-blue-700",children:(0,b.jsxs)(z.default,{href:"/tenant/booked-apartments",children:[(0,b.jsx)(s.Home,{className:"h-4 w-4"}),"My Booked Apartments"]})}),(0,b.jsx)(f.Button,{asChild:!0,className:"w-full justify-start gap-2 bg-blue-600 hover:bg-blue-700",children:(0,b.jsxs)(z.default,{href:"/tenant/apartments",children:[(0,b.jsx)(s.Home,{className:"h-4 w-4"}),"View Apartments"]})}),(0,b.jsx)(f.Button,{asChild:!0,className:"w-full justify-start gap-2 bg-blue-600 hover:bg-blue-700",children:(0,b.jsxs)(z.default,{href:"/tenant/profile",children:[(0,b.jsx)(l.FileText,{className:"h-4 w-4"}),"View Profile"]})}),(0,b.jsx)(f.Button,{asChild:!0,variant:"outline",className:"w-full justify-start gap-2",children:(0,b.jsxs)(z.default,{href:"/tenant/payment-history",children:[(0,b.jsx)(n.CreditCard,{className:"h-4 w-4"}),"Payment History"]})}),(0,b.jsx)(f.Button,{asChild:!0,variant:"outline",className:"w-full justify-start gap-2",children:(0,b.jsxs)(z.default,{href:"/tenant/maintenance",children:[(0,b.jsx)(m.Wrench,{className:"h-4 w-4"}),"Request Maintenance"]})}),(0,b.jsx)(f.Button,{asChild:!0,variant:"outline",className:"w-full justify-start gap-2",children:(0,b.jsxs)(z.default,{href:"/tenant/profile",children:[(0,b.jsx)(k.Download,{className:"h-4 w-4"}),"Download Contract"]})})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Contact Information"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Full Name"}),(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:A.full_name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,b.jsx)("p",{className:"font-semibold text-gray-900 break-all",children:A.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Phone"}),(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:A.phone||"N/A"})]})]})]})]})]}),(0,b.jsxs)("div",{className:"mt-12",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Available Apartments"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Browse and book from our available apartments"})]}),Q&&(0,b.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[(0,b.jsx)(q.CheckCircle,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"font-semibold text-green-900",children:Q})})]}),G.length>0?(0,b.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:G.map(a=>(0,b.jsxs)(g.Card,{className:"overflow-hidden hover:shadow-lg transition-shadow flex flex-col",children:[(0,b.jsx)("div",{className:"relative h-48 w-full bg-gradient-to-br from-blue-100 to-blue-50 flex items-center justify-center",children:(0,b.jsx)(s.Home,{className:"h-16 w-16 text-blue-300"})}),(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:"text-lg",children:a.name}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:["$",a.price_per_month||a.monthly_rent,"/mo"]})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4 flex-grow",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[a.bedrooms&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Bed,{className:"h-4 w-4 text-blue-600"}),(0,b.jsxs)("span",{children:[a.bedrooms," BR"]})]}),a.bathrooms&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Bath,{className:"h-4 w-4 text-blue-600"}),(0,b.jsxs)("span",{children:[a.bathrooms," BA"]})]}),(a.size||a.size_sqm)&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(w.Maximize2,{className:"h-4 w-4 text-blue-600"}),(0,b.jsxs)("span",{children:[a.size||a.size_sqm," sqm"]})]})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.description}),(0,b.jsxs)(f.Button,{onClick:()=>{V(!U),N({...M,apartment_id:a.id})},className:"w-full gap-2 bg-blue-600 hover:bg-blue-700",children:[(0,b.jsx)(x.Plus,{className:"h-4 w-4"}),"Book Apartment"]}),U&&M.apartment_id===a.id&&(0,b.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg space-y-3 border border-blue-200",children:[S&&(0,b.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:S}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Move-in Date"}),(0,b.jsx)(h.Input,{type:"date",value:M.start_date,onChange:a=>N({...M,start_date:a.target.value}),className:"w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Move-out Date"}),(0,b.jsx)(h.Input,{type:"date",value:M.end_date,onChange:a=>N({...M,end_date:a.target.value}),className:"w-full"})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,b.jsx)(f.Button,{onClick:()=>Z(a.id),disabled:O,className:"flex-1 bg-green-600 hover:bg-green-700",children:O?"Booking...":"Confirm Booking"}),(0,b.jsx)(f.Button,{onClick:()=>{V(!1),T(null)},variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})]},a.id))}):(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"pt-6 text-center",children:[(0,b.jsx)(r.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-600 text-lg",children:"No apartments available at the moment"})]})})]})]}),(0,b.jsx)(j.ChangePasswordModal,{isOpen:W,onClose:()=>X(!1),table:"tenants",userId:A?.id||""})]})}a.s(["default",()=>A])}];

//# sourceMappingURL=app_tenant_dashboard_page_tsx_9e8a8c95._.js.map