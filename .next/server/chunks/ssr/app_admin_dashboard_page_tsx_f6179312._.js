module.exports=[26086,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(21958),f=a.i(40695),g=a.i(67900),h=a.i(20005),i=a.i(38246);function j({admin:a,onLogout:c}){return(0,b.jsx)("header",{className:"border-b bg-card",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[(0,b.jsxs)(i.default,{href:"/admin/dashboard",className:"flex items-center gap-2",children:[(0,b.jsx)(g.Building2,{className:"h-6 w-6 text-primary"}),(0,b.jsx)("span",{className:"font-bold text-xl",children:"Cielo Vista Admin"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Logged in as ",(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.username})]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:c,children:[(0,b.jsx)(h.LogOut,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})})}a.i(35025);var k=a.i(9701),l=a.i(5522),m=a.i(65733);function n({isOpen:a,onClose:d,adminId:e,onSuccess:g}){let[h,i]=(0,c.useState)(!1),[j,n]=(0,c.useState)(""),[o,p]=(0,c.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),q=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q"),r=async a=>{if(a.preventDefault(),n(""),!o.currentPassword||!o.newPassword||!o.confirmPassword)return void n("All fields are required");if(o.newPassword!==o.confirmPassword)return void n("New passwords do not match");if(o.newPassword.length<6)return void n("Password must be at least 6 characters long");i(!0);try{let a=JSON.parse(localStorage.getItem("admin_session")||"{}");if(a.password!==o.currentPassword){n("Current password is incorrect"),i(!1);return}let{error:b}=await q.from("admin_accounts").update({password:o.newPassword}).eq("id",e);if(b){n("Failed to update password"),i(!1);return}a.password=o.newPassword,localStorage.setItem("admin_session",JSON.stringify(a)),p({currentPassword:"",newPassword:"",confirmPassword:""}),g(),d()}catch(a){n("An error occurred. Please try again.")}finally{i(!1)}};return(0,b.jsx)(m.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(m.DialogContent,{className:"sm:max-w-[425px]",children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsx)(m.DialogTitle,{children:"Change Password"})}),(0,b.jsxs)("form",{onSubmit:r,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),(0,b.jsx)(l.Input,{type:"password",value:o.currentPassword,onChange:a=>p({...o,currentPassword:a.target.value}),disabled:h,placeholder:"Enter your current password",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),(0,b.jsx)(l.Input,{type:"password",value:o.newPassword,onChange:a=>p({...o,newPassword:a.target.value}),disabled:h,placeholder:"Enter new password",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),(0,b.jsx)(l.Input,{type:"password",value:o.confirmPassword,onChange:a=>p({...o,confirmPassword:a.target.value}),disabled:h,placeholder:"Confirm new password",required:!0})]}),j&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:j}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:d,disabled:h,children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:h,children:h?"Updating...":"Change Password"})]})]})]})})}var o=a.i(3130),p=a.i(97895);function q({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,p.cn)("w-full caption-bottom text-sm",a),...c})})}function r({className:a,...c}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,p.cn)("[&_tr]:border-b",a),...c})}function s({className:a,...c}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,p.cn)("[&_tr:last-child]:border-0",a),...c})}function t({className:a,...c}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,p.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...c})}function u({className:a,...c}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,p.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function v({className:a,...c}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,p.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function w(){let[a,d]=(0,c.useState)([]),[e,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(!1),[j,m]=(0,c.useState)(null),[n,p]=(0,c.useState)({name:"",type:"",description:"",bedrooms:1,bathrooms:1,size_sqm:50,price_per_month:"",image_url:""}),w=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,c.useEffect)(()=>{x()},[]);let x=async()=>{try{let{data:a,error:b}=await w.from("apartments").select("*");if(b)return void console.error("Fetch error:",b);d(a||[])}catch(a){console.error("Exception:",a)}},y=async a=>{let b=a.target.files?.[0];if(b){i(!0);try{let a=`${Date.now()}-${b.name}`;console.log("Uploading to bucket: apartments, file:",a);let{error:c,data:d}=await w.storage.from("apartments").upload(a,b);if(c){console.error("Upload error details:",c),alert("Error uploading image: "+c.message),i(!1);return}console.log("Upload successful, data:",d);let{data:e}=w.storage.from("apartments").getPublicUrl(a);console.log("Public URL:",e.publicUrl),p({...n,image_url:e.publicUrl}),alert("Image uploaded successfully!")}catch(a){console.error("Upload exception:",a),alert("Error: "+a)}finally{i(!1)}}},z=async a=>{a.preventDefault(),g(!0);try{let a={name:n.name,type:n.type,description:n.description,bedrooms:parseInt(n.bedrooms.toString())||1,bathrooms:parseInt(n.bathrooms.toString())||1,size_sqm:parseInt(n.size_sqm.toString())||50,price_per_month:parseFloat(n.price_per_month)||0,image_url:n.image_url,is_available:!0};console.log("Inserting apartment:",a);let{error:b}=await w.from("apartments").insert([a]);if(b){console.error("Insert error:",b),alert("Error: "+b.message),g(!1);return}alert("Apartment added successfully!"),C(),await x()}catch(a){console.error("Exception:",a),alert("Error: "+a)}finally{g(!1)}},A=async a=>{if(a.preventDefault(),j){g(!0);try{let a={name:n.name,type:n.type,description:n.description,bedrooms:parseInt(n.bedrooms.toString())||1,bathrooms:parseInt(n.bathrooms.toString())||1,size_sqm:parseInt(n.size_sqm.toString())||50,price_per_month:parseFloat(n.price_per_month)||0,image_url:n.image_url},{error:b}=await w.from("apartments").update(a).eq("id",j);if(b){alert("Error: "+b.message),g(!1);return}alert("Apartment updated successfully!"),C(),await x()}catch(a){console.error("Exception:",a),alert("Error: "+a)}finally{g(!1)}}},B=async a=>{if(confirm("Delete this apartment?"))try{let{error:b}=await w.from("apartments").delete().eq("id",a);if(b)return void alert("Error: "+b.message);alert("Apartment deleted!"),await x()}catch(a){console.error("Error:",a)}},C=()=>{m(null),p({name:"",type:"",description:"",bedrooms:1,bathrooms:1,size_sqm:50,price_per_month:"",image_url:""})};return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsx)(o.CardTitle,{children:j?"Edit Apartment":"Add New Apartment"})}),(0,b.jsx)(o.CardContent,{children:(0,b.jsxs)("form",{onSubmit:j?A:z,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(l.Input,{placeholder:"Apartment Name",value:n.name,onChange:a=>p({...n,name:a.target.value}),required:!0}),(0,b.jsx)(l.Input,{placeholder:"Type (Studio, 1BR, 2BR)",value:n.type,onChange:a=>p({...n,type:a.target.value}),required:!0}),(0,b.jsx)(l.Input,{placeholder:"Bedrooms",type:"number",value:n.bedrooms,onChange:a=>p({...n,bedrooms:parseInt(a.target.value)||1})}),(0,b.jsx)(l.Input,{placeholder:"Bathrooms",type:"number",value:n.bathrooms,onChange:a=>p({...n,bathrooms:parseInt(a.target.value)||1})}),(0,b.jsx)(l.Input,{placeholder:"Size (sqm)",type:"number",value:n.size_sqm,onChange:a=>p({...n,size_sqm:parseInt(a.target.value)||50})}),(0,b.jsx)(l.Input,{placeholder:"Price per Month",type:"number",value:n.price_per_month,onChange:a=>p({...n,price_per_month:a.target.value}),required:!0})]}),(0,b.jsx)("textarea",{placeholder:"Description",className:"w-full p-2 border rounded",value:n.description,onChange:a=>p({...n,description:a.target.value})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload Image"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:y,disabled:h,className:"w-full p-2 border rounded"}),h&&(0,b.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Uploading..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Or paste Image URL"}),(0,b.jsx)(l.Input,{placeholder:"https://example.com/image.jpg",value:n.image_url,onChange:a=>p({...n,image_url:a.target.value})}),n.image_url&&(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("p",{className:"text-sm text-green-600",children:"Preview:"}),(0,b.jsx)("img",{src:n.image_url,alt:"Preview",className:"w-32 h-24 object-cover rounded mt-1"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{type:"submit",disabled:e||h,className:"flex-1",children:e?"Processing...":j?"Update Apartment":"Add Apartment"}),j&&(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:C,children:"Cancel"})]})]})})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)(o.CardTitle,{children:["All Apartments (",a.length,")"]})}),(0,b.jsx)(o.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(q,{children:[(0,b.jsx)(r,{children:(0,b.jsxs)(t,{children:[(0,b.jsx)(u,{children:"Image"}),(0,b.jsx)(u,{children:"Name"}),(0,b.jsx)(u,{children:"Type"}),(0,b.jsx)(u,{children:"Bedrooms"}),(0,b.jsx)(u,{children:"Price"}),(0,b.jsx)(u,{children:"Actions"})]})}),(0,b.jsx)(s,{children:a.map(a=>(0,b.jsxs)(t,{children:[(0,b.jsx)(v,{children:a.image_url&&(0,b.jsx)("img",{src:a.image_url,alt:a.name,className:"w-16 h-12 object-cover rounded"})}),(0,b.jsx)(v,{children:a.name}),(0,b.jsx)(v,{children:a.type}),(0,b.jsx)(v,{children:a.bedrooms}),(0,b.jsxs)(v,{children:["$",a.price_per_month]}),(0,b.jsxs)(v,{className:"space-x-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{m(a.id),p({name:a.name,type:a.type,description:a.description,bedrooms:a.bedrooms,bathrooms:a.bathrooms,size_sqm:a.size_sqm,price_per_month:a.price_per_month.toString(),image_url:a.image_url||""}),window.scrollTo({top:0,behavior:"smooth"})},children:"Edit"}),(0,b.jsx)(f.Button,{variant:"destructive",size:"sm",onClick:()=>B(a.id),children:"Delete"})]})]},a.id))})]})})})]})]})}var x=a.i(87682),y=a.i(5094),z=a.i(70106);let A=(0,z.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),B=(0,z.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var C=a.i(15618);let D=(0,z.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function E(){let[a,d]=(0,c.useState)([]),[e,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(""),[j,n]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)({username:"",password:"",full_name:"",email:"",phone:"",position:"",department:"",hire_date:"",status:"active"}),v=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,c.useEffect)(()=>{w()},[]);let w=async()=>{g(!0);try{let{data:a,error:b}=await v.from("employees").select("*").order("created_at",{ascending:!1});b?console.error("Error fetching employees:",b):d(a||[])}catch(a){console.error("Error:",a)}g(!1)},z=a=>{a?(s(a),u({username:a.username,password:a.password,full_name:a.full_name,email:a.email||"",phone:a.phone||"",position:a.position||"",department:a.department||"",hire_date:a.hire_date||"",status:a.status||"active"})):(s(null),u({username:"",password:"",full_name:"",email:"",phone:"",position:"",department:"",hire_date:"",status:"active"})),n(!0)},E=async()=>{if(!t.username||!t.full_name)return void alert("Please fill in required fields");try{if(r){let{error:a}=await v.from("employees").update({...t,updated_at:new Date().toISOString()}).eq("id",r.id);if(a)return void alert("Error updating employee: "+a.message)}else{let{error:a}=await v.from("employees").insert([t]);if(a)return void alert("Error adding employee: "+a.message)}n(!1),await w()}catch(a){alert("An error occurred")}},F=async()=>{try{let{error:a}=await v.from("employees").delete().eq("id",r.id);if(a)return void alert("Error deleting employee: "+a.message);q(!1),await w()}catch(a){alert("An error occurred")}},G=a.filter(a=>`${a.full_name} ${a.username} ${a.email||""}`.toLowerCase().includes(h.toLowerCase()));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Employees Management"}),(0,b.jsxs)(f.Button,{onClick:()=>z(),className:"flex items-center gap-2",children:[(0,b.jsx)(C.Plus,{className:"h-4 w-4"}),"Add Employee"]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(D,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,b.jsx)(l.Input,{placeholder:"Search by name, username, or email...",value:h,onChange:a=>i(a.target.value),className:"pl-10"})]}),(0,b.jsx)(o.Card,{children:(0,b.jsx)(o.CardContent,{className:"pt-6",children:e?(0,b.jsx)("div",{className:"text-center py-8",children:"Loading employees..."}):0===G.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No employees found"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Name"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Username"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Password"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Email"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Position"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Department"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Status"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:G.map(a=>(0,b.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"py-3 px-4 font-medium",children:a.full_name}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600",children:a.username}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm font-mono bg-gray-100 px-2 py-1 rounded max-w-xs",children:a.password||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm",children:a.email||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm",children:a.position||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm",children:a.department||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm",children:(0,b.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${"active"===a.status?"bg-green-100 text-green-800":"on-leave"===a.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:a.status})}),(0,b.jsxs)("td",{className:"py-3 px-4 text-right space-x-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>z(a),children:(0,b.jsx)(A,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"destructive",size:"sm",onClick:()=>{s(a),q(!0)},children:(0,b.jsx)(B,{className:"h-4 w-4"})})]})]},a.id))})]})})})}),(0,b.jsx)(m.Dialog,{open:j,onOpenChange:n,children:(0,b.jsxs)(m.DialogContent,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsx)(m.DialogTitle,{children:r?"Edit Employee":"Add New Employee"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Username *"}),(0,b.jsx)(l.Input,{value:t.username,onChange:a=>u({...t,username:a.target.value}),placeholder:"Username",disabled:!!r,required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Password ",r&&"(leave blank to keep current)"]}),(0,b.jsx)(l.Input,{type:"password",value:t.password,onChange:a=>u({...t,password:a.target.value}),placeholder:"Password",required:!r})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),(0,b.jsx)(l.Input,{value:t.full_name,onChange:a=>u({...t,full_name:a.target.value}),placeholder:"Full name",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email"}),(0,b.jsx)(l.Input,{type:"email",value:t.email,onChange:a=>u({...t,email:a.target.value}),placeholder:"Email"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),(0,b.jsx)(l.Input,{value:t.phone,onChange:a=>u({...t,phone:a.target.value}),placeholder:"Phone number"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Position"}),(0,b.jsxs)(x.Select,{value:t.position,onValueChange:a=>u({...t,position:a}),children:[(0,b.jsx)(x.SelectTrigger,{children:(0,b.jsx)(x.SelectValue,{placeholder:"Select position"})}),(0,b.jsx)(x.SelectContent,{children:["Manager","Supervisor","Technician","Staff","Intern"].map(a=>(0,b.jsx)(x.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Department"}),(0,b.jsxs)(x.Select,{value:t.department,onValueChange:a=>u({...t,department:a}),children:[(0,b.jsx)(x.SelectTrigger,{children:(0,b.jsx)(x.SelectValue,{placeholder:"Select department"})}),(0,b.jsx)(x.SelectContent,{children:["IT","Maintenance","Security","Administration","Cleaning"].map(a=>(0,b.jsx)(x.SelectItem,{value:a,children:a},a))})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Hire Date"}),(0,b.jsx)(l.Input,{type:"date",value:t.hire_date,onChange:a=>u({...t,hire_date:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Status"}),(0,b.jsxs)(x.Select,{value:t.status,onValueChange:a=>u({...t,status:a}),children:[(0,b.jsx)(x.SelectTrigger,{children:(0,b.jsx)(x.SelectValue,{})}),(0,b.jsx)(x.SelectContent,{children:["active","inactive","on-leave"].map(a=>(0,b.jsx)(x.SelectItem,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1).replace("-"," ")},a))})]})]})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),(0,b.jsxs)(f.Button,{onClick:E,children:[r?"Update":"Add"," Employee"]})]})]})}),(0,b.jsx)(y.AlertDialog,{open:p,onOpenChange:q,children:(0,b.jsxs)(y.AlertDialogContent,{children:[(0,b.jsx)(y.AlertDialogTitle,{children:"Delete Employee"}),(0,b.jsxs)(y.AlertDialogDescription,{children:["Are you sure you want to delete ",r?.full_name,"? This action cannot be undone."]}),(0,b.jsxs)(y.AlertDialogFooter,{children:[(0,b.jsx)(y.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(y.AlertDialogAction,{onClick:F,className:"bg-red-600",children:"Delete"})]})]})})]})}function F(){let[a,d]=(0,c.useState)([]),[e,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(null),j=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,c.useEffect)(()=>{l()},[]);let l=async()=>{try{console.log("Fetching bookings...");let{data:a,error:b}=await j.from("bookings").select("*").order("created_at",{ascending:!1});if(console.log("Bookings data:",{data:a,error:b}),b){console.error("Fetch error:",b),g(!1);return}d(a||[])}catch(a){console.error("Exception:",a)}finally{g(!1)}},m=async(a,b)=>{try{let{error:c}=await j.from("bookings").update({status:b}).eq("id",a);if(c)return void alert("Error updating status: "+c.message);alert("Status updated!"),await l()}catch(a){console.error("Error:",a)}},n=async a=>{if(window.confirm("Are you sure you want to delete this booking? This action cannot be undone.")){i(a);try{let{error:b}=await j.from("bookings").delete().eq("id",a);if(b){alert("Error deleting booking: "+b.message),i(null);return}alert("Booking deleted successfully!"),await l()}catch(a){console.error("Error:",a),alert("An error occurred while deleting the booking"),i(null)}}};return(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)(o.CardTitle,{children:["All Bookings (",a.length,")"]})}),(0,b.jsx)(o.CardContent,{children:e?(0,b.jsx)("p",{children:"Loading bookings..."}):0===a.length?(0,b.jsx)("p",{className:"text-gray-500",children:"No bookings yet"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(q,{children:[(0,b.jsx)(r,{children:(0,b.jsxs)(t,{children:[(0,b.jsx)(u,{children:"Client Name"}),(0,b.jsx)(u,{children:"Email"}),(0,b.jsx)(u,{children:"Phone"}),(0,b.jsx)(u,{children:"Apartment Type"}),(0,b.jsx)(u,{children:"Move-in Date"}),(0,b.jsx)(u,{children:"Move-out Date"}),(0,b.jsx)(u,{children:"Status"}),(0,b.jsx)(u,{children:"Action"})]})}),(0,b.jsx)(s,{children:a.map(a=>(0,b.jsxs)(t,{children:[(0,b.jsx)(v,{children:a.client_name}),(0,b.jsx)(v,{children:a.email}),(0,b.jsx)(v,{children:a.phone_number}),(0,b.jsx)(v,{children:a.apartment_type}),(0,b.jsx)(v,{children:new Date(a.start_date).toLocaleDateString()}),(0,b.jsx)(v,{children:new Date(a.end_date).toLocaleDateString()}),(0,b.jsx)(v,{children:(0,b.jsx)("span",{className:`px-2 py-1 rounded text-sm ${"confirmed"===a.status?"bg-green-100 text-green-800":"rejected"===a.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:a.status})}),(0,b.jsxs)(v,{className:"space-x-2",children:[(0,b.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>m(a.id,"confirmed"),children:"Confirm"}),(0,b.jsx)(f.Button,{size:"sm",variant:"destructive",onClick:()=>m(a.id,"rejected"),children:"Reject"}),(0,b.jsx)(f.Button,{size:"sm",variant:"destructive",onClick:()=>n(a.id),disabled:h===a.id,children:h===a.id?"Deleting...":"Delete"})]})]},a.id))})]})})})]})}var G=a.i(79808);function H(){let[a,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)("all"),m=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,c.useEffect)(()=>{n()},[]);let n=async()=>{f(!0);try{let{data:a}=await m.from("maintenance_requests").select("*").order("created_at",{ascending:!1});a&&d(a)}catch(a){console.error("Error fetching requests:",a)}f(!1)},p=async(a,b)=>{let{error:c}=await m.from("maintenance_requests").update({status:b}).eq("id",a);c||await n()},q=a.filter(a=>{let b=`${a.issue_type||""} ${a.description||""}`.toLowerCase().includes(g.toLowerCase()),c="all"===i||a.status===i;return b&&c});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center",children:(0,b.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(G.Wrench,{className:"h-6 w-6"}),"Maintenance Requests"]})}),(0,b.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"relative flex-1 min-w-64",children:[(0,b.jsx)(D,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,b.jsx)(l.Input,{placeholder:"Search by issue type or description...",value:g,onChange:a=>h(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(x.Select,{value:i,onValueChange:j,children:[(0,b.jsx)(x.SelectTrigger,{className:"w-40",children:(0,b.jsx)(x.SelectValue,{})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(x.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(x.SelectItem,{value:"in-progress",children:"In Progress"}),(0,b.jsx)(x.SelectItem,{value:"completed",children:"Completed"})]})]})]}),(0,b.jsx)("div",{className:"grid gap-4",children:e?(0,b.jsx)("div",{className:"text-center py-8",children:"Loading requests..."}):0===q.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No maintenance requests found"}):q.map(a=>(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg",children:a.issue_type}),(0,b.jsx)("p",{className:"text-gray-700 mt-2",children:a.description}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Requested: ",new Date(a.created_at).toLocaleDateString()]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("span",{className:`text-xs font-semibold px-2 py-1 rounded ${(a=>{switch(a){case"completed":return"text-green-600 bg-green-50";case"in-progress":return"text-blue-600 bg-blue-50";case"pending":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}})(a.status)}`,children:a.status.toUpperCase()})})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(x.Select,{value:a.status,onValueChange:b=>p(a.id,b),children:[(0,b.jsx)(x.SelectTrigger,{className:"w-40",children:(0,b.jsx)(x.SelectValue,{})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(x.SelectItem,{value:"in-progress",children:"In Progress"}),(0,b.jsx)(x.SelectItem,{value:"completed",children:"Completed"})]})]})})]})},a.id))})]})}function I(){let[a,d]=(0,c.useState)([]),[e,g]=(0,c.useState)(null),h=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,c.useEffect)(()=>{i()},[]);let i=async()=>{let{data:a}=await h.from("client_feedback").select("*").order("created_at",{ascending:!1});a&&d(a)},j=async a=>{if(window.confirm("Are you sure you want to delete this feedback? This action cannot be undone.")){g(a);try{let{error:b}=await h.from("client_feedback").delete().eq("id",a);if(b){alert("Error deleting feedback: "+b.message),g(null);return}alert("Feedback deleted successfully!"),await i()}catch(a){console.error("Error:",a),alert("An error occurred while deleting the feedback"),g(null)}}};return(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsx)(o.CardTitle,{children:"Client Feedback"}),(0,b.jsx)(o.CardDescription,{children:"View all feedback and reviews from clients"})]}),(0,b.jsx)(o.CardContent,{children:(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(q,{children:[(0,b.jsx)(r,{children:(0,b.jsxs)(t,{children:[(0,b.jsx)(u,{children:"Name"}),(0,b.jsx)(u,{children:"Email"}),(0,b.jsx)(u,{children:"Message"}),(0,b.jsx)(u,{children:"Rating"}),(0,b.jsx)(u,{children:"Date"}),(0,b.jsx)(u,{children:"Action"})]})}),(0,b.jsx)(s,{children:0===a.length?(0,b.jsx)(t,{children:(0,b.jsx)(v,{colSpan:6,className:"text-center text-muted-foreground",children:"No feedback yet"})}):a.map(a=>(0,b.jsxs)(t,{children:[(0,b.jsx)(v,{children:a.name}),(0,b.jsx)(v,{children:a.email}),(0,b.jsx)(v,{className:"max-w-xs truncate",children:a.message}),(0,b.jsx)(v,{children:"⭐".repeat(a.rating)}),(0,b.jsx)(v,{children:new Date(a.created_at).toLocaleDateString()}),(0,b.jsx)(v,{children:(0,b.jsx)(f.Button,{size:"sm",variant:"destructive",onClick:()=>j(a.id),disabled:e===a.id,children:e===a.id?"Deleting...":"Delete"})})]},a.id))})]})})})]})}var J=a.i(16201),K=a.i(62722),L=a.i(41710),M=a.i(46842),N=a.i(92258),O=a.i(63519),P=a.i(4720),Q=a.i(92e3);function R(){let[a,d]=(0,c.useState)(null),[e,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,m]=(0,c.useState)("pending"),[n,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(""),w=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q");(0,c.useEffect)(()=>{let a=localStorage.getItem("admin_session");a&&d(JSON.parse(a))},[]),(0,c.useEffect)(()=>{a&&(async()=>{try{i(!0);let a=w.from("tenants").select("*").order("created_at",{ascending:!1});"all"!==j&&(a=a.eq("approval_status",j));let{data:b,error:c}=await a;if(c)return void console.error("Error fetching tenants:",c);g(b||[])}catch(a){console.error("Error:",a)}finally{i(!1)}})()},[a,j]);let x=async()=>{if(n&&a)try{let{error:b}=await w.from("tenants").update({approval_status:"approved",is_active:!0,approved_by:a.id,approved_at:new Date().toISOString()}).eq("id",n.id);if(b)return void console.error("Error approving tenant:",b);g(e.map(a=>a.id===n.id?{...a,approval_status:"approved",is_active:!0}:a)),t(!1),p(null),r(null)}catch(a){console.error("Error:",a)}},z=async()=>{if(n&&a)try{let{error:b}=await w.from("tenants").update({approval_status:"rejected",is_active:!1,approved_by:a.id,approved_at:new Date().toISOString()}).eq("id",n.id);if(b)return void console.error("Error rejecting tenant:",b);g(e.map(a=>a.id===n.id?{...a,approval_status:"rejected",is_active:!1}:a)),t(!1),p(null),r(null)}catch(a){console.error("Error:",a)}},A=async()=>{if(n&&a)try{let{error:a}=await w.from("tenants").delete().eq("id",n.id);if(a)return void console.error("Error deleting tenant:",a);g(e.filter(a=>a.id!==n.id)),t(!1),p(null),r(null)}catch(a){console.error("Error:",a)}},C=e.filter(a=>{let b=u.toLowerCase();return a.full_name.toLowerCase().includes(b)||a.email.toLowerCase().includes(b)||a.username.toLowerCase().includes(b)});return h?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading tenants..."})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tenant Management"}),(0,b.jsx)("p",{className:"text-gray-600",children:"View and approve tenant account requests"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(l.Input,{placeholder:"Search by name, email, or username...",value:u,onChange:a=>v(a.target.value),className:"max-w-md"}),(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:["pending","approved","rejected","all"].map(a=>(0,b.jsxs)(f.Button,{variant:j===a?"default":"outline",onClick:()=>m(a),className:j===a?"bg-blue-600 hover:bg-blue-700":"border-gray-300",children:[a.charAt(0).toUpperCase()+a.slice(1),(0,b.jsxs)("span",{className:"ml-2 text-xs font-semibold",children:["(",e.filter(b=>"all"===a||b.approval_status===a).length,")"]})]},a))})]}),0===C.length?(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"pt-8 text-center",children:[(0,b.jsx)(Q.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsxs)("p",{className:"text-gray-500 text-lg",children:["No ","all"===j?"":j," tenant requests found"]})]})}):(0,b.jsx)("div",{className:"grid gap-4",children:C.map(a=>(0,b.jsx)(o.Card,{className:"hover:shadow-lg transition-shadow",children:(0,b.jsx)(o.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between gap-6",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:a.full_name}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["@",a.username]}),(0,b.jsxs)("div",{className:`inline-flex items-center gap-2 mt-3 px-3 py-1 rounded-full text-sm font-semibold border ${(a=>{switch(a){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"approved":return"bg-green-100 text-green-800 border-green-300";case"rejected":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}})(a.approval_status)}`,children:[(a=>{switch(a){case"pending":return(0,b.jsx)(L.Clock,{className:"h-5 w-5"});case"approved":return(0,b.jsx)(J.CheckCircle,{className:"h-5 w-5"});case"rejected":return(0,b.jsx)(K.XCircle,{className:"h-5 w-5"});default:return null}})(a.approval_status),a.approval_status.charAt(0).toUpperCase()+a.approval_status.slice(1)]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-400",children:new Date(a.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(N.Mail,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Email"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.email})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(O.Phone,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Phone"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.phone})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(P.FileText,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"ID Number"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.id_number})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(M.User,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Emergency Contact"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.emergency_contact})]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Address"}),(0,b.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[a.address,", ",a.city,", ",a.country]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Emergency Contact Phone"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.emergency_contact_phone})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Password"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 font-mono bg-gray-100 px-2 py-1 rounded",children:a.password})]})]})]}),"pending"===a.approval_status&&(0,b.jsxs)("div",{className:"flex flex-col gap-2 lg:justify-center",children:[(0,b.jsxs)(f.Button,{onClick:()=>{p(a),r("approve"),t(!0)},className:"bg-green-600 hover:bg-green-700 text-white gap-2",children:[(0,b.jsx)(J.CheckCircle,{className:"h-4 w-4"}),"Approve"]}),(0,b.jsxs)(f.Button,{onClick:()=>{p(a),r("reject"),t(!0)},variant:"destructive",className:"gap-2",children:[(0,b.jsx)(K.XCircle,{className:"h-4 w-4"}),"Reject"]}),(0,b.jsxs)(f.Button,{onClick:()=>{p(a),r("delete"),t(!0)},variant:"outline",className:"gap-2 text-red-600 border-red-300 hover:bg-red-50",children:[(0,b.jsx)(B,{className:"h-4 w-4"}),"Delete"]})]}),"approved"===a.approval_status&&(0,b.jsxs)("div",{className:"flex flex-col gap-2 lg:justify-center",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-green-700 bg-green-50 px-4 py-2 rounded-lg text-center",children:"✓ Account Active"}),(0,b.jsxs)(f.Button,{onClick:()=>{p(a),r("delete"),t(!0)},variant:"outline",className:"gap-2 text-red-600 border-red-300 hover:bg-red-50",children:[(0,b.jsx)(B,{className:"h-4 w-4"}),"Delete"]})]}),"rejected"===a.approval_status&&(0,b.jsxs)("div",{className:"flex flex-col gap-2 lg:justify-center",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-red-700 bg-red-50 px-4 py-2 rounded-lg text-center",children:"✗ Account Rejected"}),(0,b.jsxs)(f.Button,{onClick:()=>{p(a),r("delete"),t(!0)},variant:"outline",className:"gap-2 text-red-600 border-red-300 hover:bg-red-50",children:[(0,b.jsx)(B,{className:"h-4 w-4"}),"Delete"]})]})]})})},a.id))}),(0,b.jsx)(y.AlertDialog,{open:s,onOpenChange:t,children:(0,b.jsxs)(y.AlertDialogContent,{children:[(0,b.jsxs)(y.AlertDialogHeader,{children:[(0,b.jsx)(y.AlertDialogTitle,{children:"approve"===q?"Approve Tenant Account?":"reject"===q?"Reject Tenant Account?":"Delete Tenant Account?"}),(0,b.jsx)(y.AlertDialogDescription,{children:"approve"===q?`Are you sure you want to approve ${n?.full_name}'s account? They will be able to login immediately.`:"reject"===q?`Are you sure you want to reject ${n?.full_name}'s account? They will be notified.`:`Are you sure you want to delete ${n?.full_name}'s account? This action cannot be undone.`})]}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsx)(y.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(y.AlertDialogAction,{onClick:"approve"===q?x:"reject"===q?z:A,className:"approve"===q?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:"approve"===q?"Approve":"reject"===q?"Reject":"Delete"})]})]})})]})}let S=(0,z.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function T(){let[a,d]=(0,c.useState)([]),[e,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(!1),[j,n]=(0,c.useState)(!1),[p,w]=(0,c.useState)(!1),[x,z]=(0,c.useState)(""),[A,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)({username:"",password:"",confirmPassword:"",full_name:""}),[I,J]=(0,c.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(""),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(!1),X=(0,k.createBrowserClient)("https://dtwoklcuesipnczgzbxj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0d29rbGN1ZXNpcG5jemd6YnhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODU4MDAsImV4cCI6MjA3OTU2MTgwMH0.TSp3ltWMXKd1nBCHsTWg6bIdMRcMTJChUg3CdKXo35Q"),Y=async()=>{try{g(!0);let{data:a,error:b}=await X.from("admin_accounts").select("*").order("created_at",{ascending:!1});if(b&&b.message){console.error("Error fetching admins:",b.message),L("Failed to load admins");return}d(a||[])}catch(a){console.error("Error:",a),L("An error occurred while fetching admins")}finally{g(!1)}};(0,c.useEffect)(()=>{Y()},[]);let Z=a=>{let{name:b,value:c}=a.target;H(a=>({...a,[b]:c}))},$=a=>{let{name:b,value:c}=a.target;J(a=>({...a,[b]:c}))},_=async a=>{if(a.preventDefault(),(L(""),G.username.trim())?G.username.length<3?(L("Username must be at least 3 characters"),!1):G.password?G.password.length<6?(L("Password must be at least 6 characters"),!1):G.password!==G.confirmPassword?(L("Passwords do not match"),!1):!!G.full_name.trim()||(L("Full name is required"),!1):(L("Password is required"),!1):(L("Username is required"),!1))try{U(!0),L("");let{data:a}=await X.from("admin_accounts").select("id").eq("username",G.username).single();if(a){L("Username already exists"),U(!1);return}let{error:b}=await X.from("admin_accounts").insert([{username:G.username,password:G.password,full_name:G.full_name}]);if(b&&b.message){console.error("Error adding admin:",b.message),L("Failed to add admin account"),U(!1);return}N("Admin account created successfully!"),H({username:"",password:"",confirmPassword:"",full_name:""}),setTimeout(()=>{i(!1),N(""),Y()},1500)}catch(a){console.error("Error:",a),L("An error occurred while creating the admin account")}finally{U(!1)}},aa=async a=>{if(a.preventDefault(),(P(""),I.currentPassword)?I.newPassword?I.newPassword.length<6?(P("Password must be at least 6 characters"),!1):I.newPassword===I.confirmPassword||(P("Passwords do not match"),!1):(P("New password is required"),!1):(P("Current password is required"),!1))try{W(!0),P("");let{data:a}=await X.from("settings").select("setting_value").eq("setting_key","master_deletion_password").single();if(!a||a.setting_value!==I.currentPassword){P("Current password is incorrect"),W(!1);return}let{error:b}=await X.from("settings").update({setting_value:I.newPassword}).eq("setting_key","master_deletion_password");if(b&&b.message){console.error("Error updating password:",b.message),P("Failed to update password"),W(!1);return}R("Master deletion password updated successfully!"),J({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{n(!1),R("")},1500)}catch(a){console.error("Error:",a),P("An error occurred while updating the password")}finally{W(!1)}},ab=async()=>{if(E)try{D("");let{data:a}=await X.from("settings").select("setting_value").eq("setting_key","master_deletion_password").single();if(!a||a.setting_value!==x)return void D("Incorrect password");let b=localStorage.getItem("admin_session");if(b&&JSON.parse(b).id===E.id)return void D("You cannot delete your own admin account");let{error:c}=await X.from("admin_accounts").delete().eq("id",E.id);if(c&&c.message){console.error("Error deleting admin:",c.message),D("Failed to delete admin");return}N(`Admin "${E.username}" deleted successfully`),setTimeout(()=>{N(""),w(!1),F(null),Y()},1500)}catch(a){console.error("Error:",a),D("An error occurred while deleting the admin")}};return e?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:"Loading admins..."}):(0,b.jsxs)("div",{className:"space-y-6",children:[K&&(0,b.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:K}),M&&(0,b.jsxs)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:["✓ ",M]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsxs)(m.Dialog,{open:j,onOpenChange:n,children:[(0,b.jsx)(m.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",className:"gap-2",children:[(0,b.jsx)(S,{className:"h-4 w-4"}),"Settings"]})}),(0,b.jsxs)(m.DialogContent,{children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsx)(m.DialogTitle,{children:"Change Master Deletion Password"})}),(0,b.jsxs)("form",{onSubmit:aa,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),(0,b.jsx)(l.Input,{type:"password",name:"currentPassword",value:I.currentPassword,onChange:$,placeholder:"Enter current password",disabled:V})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),(0,b.jsx)(l.Input,{type:"password",name:"newPassword",value:I.newPassword,onChange:$,placeholder:"Enter new password",disabled:V})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),(0,b.jsx)(l.Input,{type:"password",name:"confirmPassword",value:I.confirmPassword,onChange:$,placeholder:"Confirm new password",disabled:V})]}),O&&(0,b.jsx)("div",{className:"text-red-500 text-sm",children:O}),Q&&(0,b.jsx)("div",{className:"text-green-500 text-sm",children:Q}),(0,b.jsx)(f.Button,{type:"submit",disabled:V,className:"w-full bg-blue-600 hover:bg-blue-700",children:V?"Updating...":"Update Password"})]})]})]}),(0,b.jsxs)(m.Dialog,{open:h,onOpenChange:i,children:[(0,b.jsx)(m.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{className:"gap-2 bg-blue-600 hover:bg-blue-700",children:[(0,b.jsx)(C.Plus,{className:"h-4 w-4"}),"Add New Admin"]})}),(0,b.jsxs)(m.DialogContent,{children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsx)(m.DialogTitle,{children:"Add New Admin Account"})}),(0,b.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Username"}),(0,b.jsx)(l.Input,{type:"text",name:"username",value:G.username,onChange:Z,placeholder:"Enter username",disabled:T})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),(0,b.jsx)(l.Input,{type:"text",name:"full_name",value:G.full_name,onChange:Z,placeholder:"Enter full name",disabled:T})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Password"}),(0,b.jsx)(l.Input,{type:"password",name:"password",value:G.password,onChange:Z,placeholder:"Enter password",disabled:T})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm Password"}),(0,b.jsx)(l.Input,{type:"password",name:"confirmPassword",value:G.confirmPassword,onChange:Z,placeholder:"Confirm password",disabled:T})]}),K&&(0,b.jsx)("div",{className:"text-red-500 text-sm",children:K}),M&&(0,b.jsx)("div",{className:"text-green-500 text-sm",children:M}),(0,b.jsx)(f.Button,{type:"submit",disabled:T,className:"w-full bg-blue-600 hover:bg-blue-700",children:T?"Creating...":"Create Admin"})]})]})]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)(o.CardTitle,{children:["Admin Accounts (",a.length,")"]})}),(0,b.jsx)(o.CardContent,{children:0===a.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No admins found"}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(q,{children:[(0,b.jsx)(r,{children:(0,b.jsxs)(t,{children:[(0,b.jsx)(u,{children:"Username"}),(0,b.jsx)(u,{children:"Full Name"}),(0,b.jsx)(u,{children:"Created"}),(0,b.jsx)(u,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(s,{children:a.map(a=>(0,b.jsxs)(t,{children:[(0,b.jsx)(v,{className:"font-medium",children:a.username}),(0,b.jsx)(v,{children:a.full_name||"-"}),(0,b.jsx)(v,{children:new Date(a.created_at).toLocaleDateString()}),(0,b.jsx)(v,{className:"text-right",children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{F(a),z(""),D(""),w(!0)},children:(0,b.jsx)(B,{className:"h-4 w-4"})})})]},a.id))})]})})})]}),(0,b.jsx)(y.AlertDialog,{open:p,onOpenChange:w,children:(0,b.jsxs)(y.AlertDialogContent,{children:[(0,b.jsxs)(y.AlertDialogHeader,{children:[(0,b.jsx)(y.AlertDialogTitle,{children:"Delete Admin Account"}),(0,b.jsxs)(y.AlertDialogDescription,{children:['Enter the master deletion password to confirm deletion of admin "',E?.username,'". This action cannot be undone.']})]}),(0,b.jsxs)("div",{className:"py-4",children:[(0,b.jsx)(l.Input,{type:"password",placeholder:"Enter master deletion password",value:x,onChange:a=>{z(a.target.value),D("")},className:"mb-2"}),A&&(0,b.jsx)("div",{className:"text-red-500 text-sm",children:A})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(y.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(y.AlertDialogAction,{onClick:ab,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}var U=a.i(63910),V=a.i(60246),W=a.i(41675),X=a.i(63588),Y=a.i(81402),Z=a.i(81010),$=a.i(77156);let _=(0,z.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);function aa(){let a=(0,d.useRouter)(),[g,h]=(0,c.useState)(null),[k,l]=(0,c.useState)(!1),[m,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{let b=localStorage.getItem("admin_session");if(!b)return void a.push("/login?redirect=admin");try{h(JSON.parse(b))}catch(b){a.push("/login?redirect=admin")}q(!1)},[a]),p)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):g?(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)(j,{admin:g,onLogout:()=>{localStorage.removeItem("admin_session"),a.push("/login")}}),(0,b.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"Dashboard"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Welcome back, ",g.username,"!"]})]}),(0,b.jsxs)(f.Button,{onClick:()=>l(!0),variant:"outline",className:"flex items-center gap-2",children:[(0,b.jsx)(Y.Key,{className:"h-4 w-4"}),"Change Password"]})]}),m&&(0,b.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6",children:"✓ Password changed successfully!"}),(0,b.jsxs)(e.Tabs,{defaultValue:"apartments",className:"space-y-8",children:[(0,b.jsxs)(e.TabsList,{className:"grid w-full grid-cols-7 lg:w-auto",children:[(0,b.jsxs)(e.TabsTrigger,{value:"apartments",className:"flex items-center gap-2",children:[(0,b.jsx)(U.Building,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Apartments"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"tenants",className:"flex items-center gap-2",children:[(0,b.jsx)(Z.Home,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Tenants"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"employees",className:"flex items-center gap-2",children:[(0,b.jsx)(V.Users,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Employees"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"admins",className:"flex items-center gap-2",children:[(0,b.jsx)(_,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Admins"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"bookings",className:"flex items-center gap-2",children:[(0,b.jsx)(W.Calendar,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Bookings"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"maintenance",className:"flex items-center gap-2",children:[(0,b.jsx)(G.Wrench,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Maintenance"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"feedback",className:"flex items-center gap-2",children:[(0,b.jsx)(X.MessageSquare,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Feedback"})]})]}),(0,b.jsx)(e.TabsContent,{value:"apartments",children:(0,b.jsx)(w,{})}),(0,b.jsx)(e.TabsContent,{value:"tenants",children:(0,b.jsx)(R,{})}),(0,b.jsx)(e.TabsContent,{value:"employees",children:(0,b.jsx)(E,{})}),(0,b.jsx)(e.TabsContent,{value:"admins",children:(0,b.jsx)(T,{})}),(0,b.jsx)(e.TabsContent,{value:"bookings",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsx)(f.Button,{asChild:!0,className:"gap-2 bg-blue-600 hover:bg-blue-700",children:(0,b.jsxs)(i.default,{href:"/admin/bookings",children:[(0,b.jsx)($.Eye,{className:"h-4 w-4"}),"View All Bookings"]})})}),(0,b.jsx)(F,{})]})}),(0,b.jsx)(e.TabsContent,{value:"maintenance",children:(0,b.jsx)(H,{})}),(0,b.jsx)(e.TabsContent,{value:"feedback",children:(0,b.jsx)(I,{})})]})]}),(0,b.jsx)(n,{isOpen:k,onClose:()=>l(!1),adminId:g.id,onSuccess:()=>{o(!0),setTimeout(()=>o(!1),3e3)}})]}):null}a.s(["default",()=>aa],26086)}];

//# sourceMappingURL=app_admin_dashboard_page_tsx_f6179312._.js.map